function run(key,context){that.context=context;var exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t){e.exports={name:"Style Master",version:"1.0.1",identifier:"com.aparajita.style-master",description:"Shared style renaming.",author:"Aparajita Fishman",authorEmail:"aparajita@aparajita.com",homepage:"https://github.com/aparajita/sketch-style-master",compatibleVersion:4,bundleVersion:1,disableCocoaScriptPreprocessor:!0,appcast:"https://raw.githubusercontent.com/aparajita/sketch-style-master/master/appcast.xml",nibProject:"nib",nibBundle:"UIBundle",commands:[{name:"Rename Text Styles",script:"plugin.js",handler:"renameTextStyles",identifier:"rename-text-styles",description:"Rename shared text styles",icon:"rename-styles.png"},{name:"Rename Layer Styles",script:"plugin.js",handler:"renameLayerStyles",identifier:"rename-layer-styles",description:"Rename shared layer styles",icon:"rename-styles.png"}],menu:{title:"Style Master",items:["rename-text-styles","rename-layer-styles"]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}),n(0)},function(e,t,n){"use strict";function r(e){var t=e.document.documentData().layerTextStyles();new a.SharedStyleRenamer(e,t,"text").run()}function i(e){var t=e.document.documentData().layerStyles();new a.SharedStyleRenamer(e,t,"layer").run()}Object.defineProperty(t,"__esModule",{value:!0}),t.renameTextStyles=r,t.renameLayerStyles=i;var a=n(3)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return e.charAt(0).toUpperCase()+e.slice(1)}function a(e){var t=e.document.documentData().layerTextStyles();new y(e,t,"text").run()}function o(e){var t=e.document.documentData().layerStyles();new y(e,t,"layer").run()}Object.defineProperty(t,"__esModule",{value:!0}),t.SharedStyleRenamer=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.renameTextStyles=a,t.renameLayerStyles=o;var s=n(4),c=n(5);n(7),n(8);var u=n(0),h=NSMakeSize(16,2),y=t.SharedStyleRenamer=function(){function e(t,n,a){r(this,e),this.context=t,this.sketch=t.api(),this.styles=n,this.styleInfo=[],this.renamedStyles=[],this.find="",this.replace="",this.cellFontRegular=NSFont.systemFontOfSize(NSFont.systemFontSize()),this.cellFontBold=NSFont.boldSystemFontOfSize(NSFont.systemFontSize()),this.layerType=a,this.dialogTitle="Rename "+i(a)+" Styles",this.ivars={styles:n,renameCount:0,findPattern:"",ignoreCase:!1,useRegex:!1,replacePattern:"",showMatchingStyles:!1,autoScroll:!0,findColor:NSColor.textColor()}}return l(e,[{key:"makeAlert",value:function(){var e=NSAlert.new();e.setMessageText(this.dialogTitle);var t=NSImage.alloc().initByReferencingFile(this.sketch.resourceNamed("rename-styles@2x.png").path());return e.setIcon(t),e}},{key:"loadNib",value:function(){this.nib=new c.NibUI(this.context,"UIBundle","RenameStyles",this,this.ivars),this.nib.outlets.window.setTitle(this.dialogTitle),this.nib.outlets.versionLabel.setStringValue("v"+u.version)}},{key:"windowWillClose",value:function(){NSApp.stopModal()}},{key:"controlTextDidChange",value:function(e){var t=e.object().tag();1==t?this.searchForMatchingStyles():2==t&&this.updateReplacedNames()}},{key:"toggleShowOnlyMatchingStyles",value:function(){this.nib.ivars.showMatchingStyles.boolValue()||this.resetRenamedStyles(),this.searchForMatchingStyles()}},{key:"toggleFindOption",value:function(){this.searchForMatchingStyles()}},{key:"toggleAutoscroll",value:function(){this.scrollToFirstRenamedStyle()}},{key:"handleRename",value:function(){this.renameStyles(),NSApp.stopModal()}},{key:"handleApply",value:function(){this.applyRename()}},{key:"handleCancel",value:function(){NSApp.stopModal()}},{key:"applyRename",value:function(){this.renameStyles(),this.initStyleInfo(),this.nib.ivars.findPattern="",this.nib.ivars.replacePattern="",this.nib.ivars.showMatchingStyles=!1,this.nib.outlets.window.makeFirstResponder(this.nib.outlets.window.initialFirstResponder()),this.searchForMatchingStyles()}},{key:"scrollToFirstRenamedStyle",value:function(){if(this.nib.ivars.autoScroll.boolValue()){var e=this.nib.outlets.scrollView.contentInsets(),t=NSMakePoint(0,0);if(this.renamedStyles.length>0)for(var n=0;n<this.renamedStyles.length;n++){var r=this.renamedStyles[n];if(r.newName.length>0){t=this.matrix.cellFrameAtRow_column(n,0).origin;break}}else t=this.matrix.cellFrameAtRow_column(0,0).origin;t.y-=e.top-1,this.matrix.scrollPoint(t),this.nib.outlets.scrollView.reflectScrolledClipView(this.nib.outlets.scrollView.contentView())}}},{key:"searchForMatchingStyles",value:function(){var e=this.nib.ivars.ignoreCase.boolValue()?"gi":"g",t=!!this.nib.ivars.useRegex.boolValue(),n=String(this.nib.ivars.findPattern||"");try{this.find=t?new RegExp(n,e):new RegExp((0,s.regExpEscape)(n),e),this.nib.ivars.findColor=NSColor.textColor()}catch(t){this.nib.ivars.findColor=NSColor.redColor(),n="",this.find=new RegExp("",e)}this.updateStylesToRename(0===n.length),this.setMatrixData(),this.scrollToFirstRenamedStyle()}},{key:"updateReplacedNames",value:function(){this.replace=String(this.nib.ivars.replacePattern||""),this.updateRenamedStyles(),this.setMatrixData()}},{key:"initStyleInfo",value:function(){var e=this.styles.objects();this.styleInfo=new Array(e.length);for(var t=0;t<e.length;t++){var n=e[t];this.styleInfo[t]={style:n,name:n.name()}}this.styleInfo.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}),this.nib.ivars.renameCount=0,this.resetRenamedStyles()}},{key:"resetRenamedStyles",value:function(){this.renamedStyles=new Array(this.styleInfo.length);for(var e=0;e<this.styleInfo.length;e++){var t=this.styleInfo[e];this.renamedStyles[e]={style:t.style,oldName:t.name,newName:""}}}},{key:"updateStylesToRename",value:function(e){for(var t=[],n=0,r=0;r<this.styleInfo.length;r++){var i=this.styleInfo[r],a=!e&&this.find.test(i.name),o=void 0;a?(o=i.name.replace(this.find,this.replace),0===o.length?o="<empty>":n++,this.nib.ivars.showMatchingStyles.boolValue()?t.push({style:i.style,oldName:i.name,newName:o}):this.renamedStyles[r].newName=o):this.nib.ivars.showMatchingStyles.boolValue()||(this.renamedStyles[r].newName="")}this.nib.ivars.showMatchingStyles.boolValue()&&(this.renamedStyles=t),this.nib.ivars.renameCount=n}},{key:"updateRenamedStyles",value:function(){var e=0,t=!0,n=!1,r=void 0;try{for(var i,a=this.renamedStyles[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;o.newName&&(o.newName=o.oldName.replace(this.find,this.replace),0===o.newName.length?o.newName="<empty>":e++)}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}this.nib.ivars.renameCount=e}},{key:"renameStyles",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.renamedStyles[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var a=r.value;if(a.newName.length>0){var o=a.style.copy();o.setName(a.newName),a.style.syncPropertiesFromObject(o)}}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}this.context.document.reloadInspector()}},{key:"alignLabelWithColumn",value:function(e,t){var n=this.nib.outlets.scrollView.contentInsets(),r=this.nib.outlets.scrollView.frame().origin,i=this.matrix.cellFrameAtRow_column(0,t).origin,a=e.frame().origin;a.x=r.x+n.left+i.x,e.setFrameOrigin(a)}},{key:"setMatrixData",value:function(){var e=0;this.matrix.renewRows_columns(this.renamedStyles.length,2),this.matrix.sizeToCells();for(var t=this.matrix.cells(),n=0;n<this.renamedStyles.length;n++){var r=this.renamedStyles[n],i=2*n,a=t[i];a.setFont(0===r.newName.length?this.cellFontRegular:this.cellFontBold),a.setStringValue(r.oldName);var o=a.cellSize();e=Math.max(e,o.width),a=t[i+1],a.setFont(this.cellFontRegular),a.setStringValue(r.newName),o=a.cellSize(),e=Math.max(e,o.width)}return NSMakeSize(e,t[0].cellSize().height)}},{key:"initMatrix",value:function(){var e=NSBezelBorder,t=this.nib.outlets.scrollView.frame().size,n=NSScrollView.contentSizeForFrameSize_horizontalScrollerClass_verticalScrollerClass_borderType_controlSize_scrollerStyle(t,null,NSScroller,e,NSRegularControlSize,NSScrollerStyleOverlay),r=this.nib.outlets.scrollView.contentInsets();n.width-=r.left+r.right,n.height-=r.top+r.bottom;var i=NSMakeSize(100,16),a=NSCell.alloc().initTextCell("");this.matrix=NSMatrix.alloc().initWithFrame_mode_prototype_numberOfRows_numberOfColumns(NSMakeRect(0,0,2*i.width,i.height*this.renamedStyles.length),NSListModeMatrix,a,this.renamedStyles.length,2),i=this.setMatrixData(),i.width*=1.25;var o=Math.floor(t.width/2);i.width=Math.max(i.width,o),this.matrix.setCellSize(CGSizeMake(i.width,i.height)),this.matrix.setIntercellSpacing(h),this.matrix.sizeToCells(),this.nib.outlets.scrollView.setDocumentView(this.matrix),this.alignLabelWithColumn(this.nib.outlets.beforeLabel,0),this.alignLabelWithColumn(this.nib.outlets.afterLabel,1);var l=27*i.height;l+=26*h.height;var s=NSMakeSize(this.matrix.frame().size.width,l),c=NSScrollView.frameSizeForContentSize_horizontalScrollerClass_verticalScrollerClass_borderType_controlSize_scrollerStyle(s,null,NSScroller,e,NSRegularControlSize,NSScrollerStyleOverlay);c.width+=r.left+r.right,c.height+=r.top+r.bottom;var u=NSMakeSize(c.width-t.width,c.height-t.height),y=this.nib.outlets.window.frame();y.size.width+=u.width,y.size.height+=u.height;var d=this.nib.outlets.window.minSize();y.size.width=Math.max(y.size.width,d.width),y.size.height=Math.max(y.size.height,d.height),this.nib.outlets.window.setFrame_display(y,!0)}},{key:"showAlert",value:function(e){var t=this.makeAlert();t.setInformativeText(e),t.runModal()}},{key:"showFindDialog",value:function(){if(0===this.styles.numberOfSharedStyles()){var e=this.makeAlert();return e.setInformativeText("This document has no shared "+this.layerType+" styles."),e.runModal(),0}return this.loadNib(),this.initStyleInfo(),this.initMatrix(),NSApp.runModalForWindow(this.nib.outlets.window)}},{key:"run",value:function(){var e=this.showFindDialog();return 0!==e&&this.nib.outlets.window.orderOut(null),e}}]),e}()},function(e,t,n){"use strict";function r(e){return String(e).replace(/([-()[\]{}+?*.$^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}Object.defineProperty(t,"__esModule",{value:!0}),t.regExpEscape=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.NibUI=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(6),l=function(e){return e&&e.__esModule?e:{default:e}}(o);t.NibUI=function(){function e(t,n,i,a,o){r(this,e);var l=t.plugin.urlForResourceNamed(n).path();this._bundle=NSBundle.bundleWithPath(l),this._nibName=i,this._delegate=a,this.outlets=Object.create(null),this.ivars=Object.create(null),this._delegateProxy=null,this._createNibOwner(i);var s=this._loadConnections(i);this._prepareOutletConnections(s.outlets),a&&this._connectActionsToDelegate(s.actions,a),o&&this._addIvars(o),this._registerNibOwner(),o&&this._initIvars(o),this._load()}return a(e,[{key:"_createNibOwner",value:function(e){var t=void 0;do{t=e+NSUUID.UUID().UUIDString()}while(null!=NSClassFromString(t));this._cls=MOClassDescription.allocateDescriptionForClassWithName_superclass_(t,NSObject);var n=MOProtocolDescription.descriptionForProtocolWithName("NSObject");this._cls.addProtocol(n)}},{key:"_registerNibOwner",value:function(){this._cls.registerClass(),this._nibOwner=NSClassFromString(this._cls.name()).alloc().init()}},{key:"_prepareOutletConnections",value:function(e){for(var t=this,n=0;n<e.length;n++)!function(n){var r=e[n],i="set"+r.charAt(0).toUpperCase()+r.substring(1)+":",a=function(e){t.outlets[r]=e};t._cls.addInstanceMethodWithSelector_function(NSSelectorFromString(i),a)}(n)}},{key:"_connectDelegateMethods",value:function(){if(this._delegate){var e=[],t=null;if("window"in this.outlets?(e.push(this.outlets.window),t=this.outlets.window.contentView()):"view"in this.outlets&&(t=this.outlets.view),t&&(this._checkForTextViewsToConnect(t,e),e.length)){var n=this._getDelegateProxy();if(n){var r=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){o.value.setDelegate(n)}}catch(e){i=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw a}}}}}}},{key:"_checkForTextViewsToConnect",value:function(e,t){var n=e.subviews(),r=!0,i=!1,a=void 0;try{for(var o,l=Array.from(n)[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var s=o.value;s.isKindOfClass(NSTextField)&&s.isEditable()&&s.tag()>0&&t.push(s),this._checkForTextViewsToConnect(s,t)}}catch(e){i=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw a}}}},{key:"_getDelegateProxy",value:function(){if(!this._delegateProxy){var e=["windowWillClose:","control:textShouldBeginEditing:","controlTextDidBeginEditing:","controlTextDidChange:","control:textShouldEndEditing:","controlTextDidEndEditing:"],t={},n=!0,r=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value,c=s.replace(/(:.)/g,function(e,t){return t.charAt(1).toUpperCase()}).replace(/:$/,""),u=this._delegate[c];u&&(t[s]=u.bind(this._delegate))}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}var h=new l.default(t);this._delegateProxy=h.getClassInstance()}return this._delegateProxy}},{key:"_connectActionsToDelegate",value:function(e,t){var n=this,r=!0,i=!1,a=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var s=o.value;!function(e){var r=e.slice(0,-1),i=t[r];if("function"==typeof i){var a=function(e){try{i.call(t,e)}catch(e){log(NSString.stringWithFormat("%@: %@\nStack:\n%@",e.name,e.message,e.stack))}};n._cls.addInstanceMethodWithSelector_function(NSSelectorFromString(e),a)}}(s)}}catch(e){i=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw a}}}},{key:"_addIvars",value:function(e){var t=this,n=!0,r=!1,i=void 0;try{for(var a,o=Object.keys(e)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var l=a.value;(function(n){var r=e[n],i=t.constructor._typeEncodingForValue(r);if(!i)return log("Cannot determine the type encoding for the ivar '"+n+"', value = "+r),"continue";t._cls.addInstanceVariableWithName_typeEncoding(n,i)?Object.defineProperty(t.ivars,n,{get:function(){return t.getIvar(n)},set:function(e){return t.setIvar(n,e)}}):log("Unable to add ivar: "+n)})(l)}}catch(e){r=!0,i=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}}},{key:"_initIvars",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=Object.keys(e)[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.setIvar(o,e[o])}}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}},{key:"_loadConnections",value:function(e){var t=this._bundle.resourcePath()+"/"+e+".json",n=NSString.stringWithContentsOfFile_encoding_error(t,NSUTF8StringEncoding,null);return n?JSON.parse(n):{outlets:[],actions:[]}}},{key:"_load",value:function(){var e=MOPointer.alloc().initWithValue(null);if(!this._bundle.loadNibNamed_owner_topLevelObjects(this._nibName,this._nibOwner,e))throw new Error("Could not load nib '"+this._nibName+"'");this._connectDelegateMethods()}},{key:"getIvar",value:function(e){return this._nibOwner.valueForKey(e)}},{key:"setIvar",value:function(e,t){this._nibOwner.setValue_forKey(t,e)}}],[{key:"_typeEncodingForValue",value:function(e){switch(void 0===e?"undefined":i(e)){case"string":case"object":return"@";case"number":return"d";case"boolean":return"i";default:return null}}}]),e}()},function(module,exports,__webpack_require__){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),MochaJSDelegate=function(){function MochaJSDelegate(e,t){if(_classCallCheck(this,MochaJSDelegate),this.uniqueClassName="MochaJSDelegate_DynamicClass_"+NSUUID.UUID().UUIDString(),this.delegateClassDesc=MOClassDescription.allocateDescriptionForClassWithName_superclass_(this.uniqueClassName,t||NSObject),this.delegateClassDesc.registerClass(),this.handlers={},"object"===(void 0===e?"undefined":_typeof(e))){var n=Object.keys(e),r=!0,i=!1,a=void 0;try{for(var o,l=n[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var s=o.value;this.setHandlerForSelector(s,e[s])}}catch(e){i=!0,a=e}finally{try{!r&&l.return&&l.return()}finally{if(i)throw a}}}}return _createClass(MochaJSDelegate,[{key:"setHandlerForSelector",value:function setHandlerForSelector(selectorString,func){var handlerHasBeenSet=selectorString in this.handlers;if(this.handlers[selectorString]=func,!handlerHasBeenSet){for(var args=[],regex=/:/g;regex.exec(selectorString);)args.push("arg"+args.length);var body="{\n        try {\n          return func.apply(this, arguments)\n        }\n        catch(ex) {\n          log(ex)\n        }\n      }",code=NSString.stringWithFormat("(function (%@) %@)",args.join(", "),body),dynamicFunction=eval(String(code)),selector=NSSelectorFromString(selectorString);this.delegateClassDesc.addInstanceMethodWithSelector_function_(selector,dynamicFunction)}}},{key:"removeHandlerForSelector",value:function(e){delete this.handlers[e]}},{key:"getHandlerForSelector",value:function(e){return this.handlers[e]}},{key:"getAllHandlers",value:function(){return this.handlers}},{key:"getClass",value:function(){return NSClassFromString(this.uniqueClassName)}},{key:"getClassInstance",value:function(){return this.getClass().new()}}]),MochaJSDelegate}();exports.default=MochaJSDelegate},function(e,t){e.exports="84296010-5b9c-11e8-b27b-c1a53679faec"},function(e,t){e.exports="8414c6a0-5b9c-11e8-b27b-c1a53679faec"}]);"default"===key&&"function"==typeof exports?exports(context):exports[key](context)}var that=this;that.onRun=run.bind(this,"default"),that.renameTextStyles=run.bind(this,"renameTextStyles"),that.renameLayerStyles=run.bind(this,"renameLayerStyles");